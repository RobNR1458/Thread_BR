AWSTemplateFormatVersion: '2010-09-09'
Description: 'Timestream database and table for wildfire sensor data'

Resources:
  WildfireSensorDatabase:
    Type: AWS::Timestream::Database
    Properties:
      DatabaseName: wildfire-sensor-db

  SensorReadingsTable:
    Type: AWS::Timestream::Table
    Properties:
      DatabaseName: !Ref WildfireSensorDatabase
      TableName: sensor-readings
      RetentionProperties:
        MemoryStoreRetentionPeriodInHours: 24   # 1 day in memory (fast queries)
        MagneticStoreRetentionPeriodInDays: 90  # 90 days on disk (cost-effective)
      MagneticStoreWriteProperties:
        EnableMagneticStoreWrites: true

Outputs:
  DatabaseName:
    Description: Timestream database name
    Value: !Ref WildfireSensorDatabase
    Export:
      Name: WildfireSensorDatabaseName

  TableName:
    Description: Timestream table name
    Value: !Ref SensorReadingsTable
    Export:
      Name: WildfireSensorTableName

  DatabaseArn:
    Description: Timestream database ARN
    Value: !GetAtt WildfireSensorDatabase.Arn
    Export:
      Name: WildfireSensorDatabaseArn

{
  "ruleName": "SensorToS3Archive",
  "description": "Archive all sensor data to S3 for long-term storage",
  "sql": "SELECT *, timestamp() as timestamp FROM 'thread/sensores'",
  "actions": [
    {
      "s3": {
        "bucketName": "REPLACE_WITH_S3_BUCKET_NAME",
        "key": "year=${timestamp().format('yyyy')}/month=${timestamp().format('MM')}/day=${timestamp().format('dd')}/hour=${timestamp().format('HH')}/${newuuid()}.json",
        "roleArn": "REPLACE_WITH_IOT_S3_ROLE_ARN"
      }
    }
  ],
  "ruleDisabled": false,
  "awsIotSqlVersion": "2016-03-23"
}
